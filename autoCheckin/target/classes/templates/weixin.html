<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Insert title here</title>
</head>
<body>
	<h1>
		欢迎： <span th:text="${nickname}"></span>
	</h1>
	<button id="pay" onclick="pay();" style="height:500px;width:500px">微信支付</button>
</body>
<script src="jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script type="text/javascript">
	$(document).ready(function() {
		
	});
	

	function pay(){
		$.ajax({
			url : 'wx/makeOrder',
			type : 'GET',
			dataType : 'json',
			data : {
				money : 0.01,
				body : "测试BODY"
			},
			success : function(msg) {
				alert(JSON.stringify(msg));
				wx.config({
				    debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
				    appId: 'wxbbea6d917de31d2f', // 必填，公众号的唯一标识
				    timestamp: msg.TIMESTAMP, // 必填，生成签名的时间戳
				    nonceStr: msg.NONCESTR, // 必填，生成签名的随机串
				    signature: msg.PAYSIGN,// 必填，签名，见附录1
				    jsApiList: ['chooseWXPay'] // 必填，需要使用的JS接口列表，这里只写支付的
				});
				alert("config配置成功");
				wx.chooseWXPay({
				    timestamp: msg.TIMESTAMP,
				    nonceStr: msg.NONCESTR, 
				    package: msg.PACKAGE,
				    signType: 'MD5',
				    paySign: msg.PAYSIGN, 
				    success: function (res) {
				        alert("支付成功");
				    }
				});
			},
			error : function(data) {
				alert("error");
			},
		});
		
	}
	
</script>
</html>